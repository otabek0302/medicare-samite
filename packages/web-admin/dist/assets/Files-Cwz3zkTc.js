import{w as Q,r as l,x as de,v as e,B as o,T as L,R as oe,S as ue,y as z,U as he,z as q,J as v,W as be,L as R,O as fe}from"./index-BFPSIpCx.js";import{e as Ne,f as ge}from"./index-xAROFF34.js";import{u as Fe}from"./SettingData-DvTyOSTZ.js";import{F as xe}from"./index-C7DuEf2v.js";import{V as pe,u as je,N as De,S as C,g as Ee,D as ke,P as ve,i as Pe}from"./Dashboard-CmmBgoMl.js";import{u as H}from"./HasPermission-Dz1RX8IC.js";import{U as we,D as Ve}from"./DeletePatientFile-BBe-fceJ.js";import{i as Ae}from"./image-4nR63Jb_.js";import{a as ye,u as S,I as B}from"./index-CexvglWR.js";import{h as _e,u as Ce,M as Se,b as ze,a as Ie,c as Me,g as Oe,d as Ye,F as T,e as Le,f,L as Re}from"./index.esm-Cjy54hoM.js";import{u as Be}from"./UsePatientsData-VzkZ5rkb.js";import{U as Te}from"./UsersComboBox-C8RnCPnU.js";import{D as $}from"./createLucideIcon-C1VZi4Qy.js";import{d as U,I,F as j}from"./utils-DGMmCGlW.js";import"./tr-BasSmpYP.js";import"./visually-hidden.style-BGGO2DOy.js";import"./popover-CAv5j0af.js";function $e({isOpen:n,onClose:s}){const{t:a}=Q(),[c,d]=l.useState(),[N,u]=l.useState(null),g=l.useRef(),{register:P,handleSubmit:w,reset:D}=_e(),E=de(),t=Ce(),h=5*1024*1024,{patientsData:V}=Be(),[F,A]=l.useState(),k=r=>{r.preventDefault();const i=r.dataTransfer.files[0];i&&i.size>h?f(t,"error",a("files.messages.sizeError")):u(i)},x=r=>{r.preventDefault()},y=r=>{const i=r.target.files[0];i&&i.size>h?f(t,"error",a("files.messages.sizeError")):u(i)},_=async r=>{if(!F)return f(t,"error",a("files.messages.patientError"));if(!N)return f(t,"error",a("files.messages.fileError"));let i={...r,patient_id:F.id,file:N};try{d(!0);const b=await he(q.token,"add_patient_file",i);d(!1),b.response===200?(f(t,"success",a("files.messages.success")),E.invalidateQueries(["patient-files",F.id]),E.invalidateQueries(["all-files"]),u(null),D(),s()):f(t,"error",b.message)}catch(b){d(!1),f(t,"error",JSON.stringify(b))}};return e.jsxDEV(Se,{isOpen:n,onClose:s,isCentered:!0,size:"lg",children:[e.jsxDEV(ze,{},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:99,columnNumber:7},this),e.jsxDEV(Ie,{as:"form",onSubmit:w(_),children:[e.jsxDEV(Me,{fontSize:18,py:2,children:a("files.title")},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:103,columnNumber:9},this),e.jsxDEV(Oe,{},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:108,columnNumber:9},this),e.jsxDEV($,{},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:109,columnNumber:9},this),e.jsxDEV(Ye,{children:e.jsxDEV(o,{pb:3,children:[e.jsxDEV(U,{isRequired:!0,children:[e.jsxDEV(T,{children:a("files.form.title")},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:113,columnNumber:15},this),e.jsxDEV(Te,{data:V,name:"Patient",setState:A,addNew:!1},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:115,columnNumber:15},this)]},void 0,!0,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:112,columnNumber:13},this),e.jsxDEV(U,{isRequired:!0,mt:5,children:[e.jsxDEV(T,{children:a("files.form.fileName")},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:125,columnNumber:15},this),e.jsxDEV(I,{placeholder:"Name",...P("file_name",{required:!0})},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:126,columnNumber:15},this)]},void 0,!0,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:122,columnNumber:13},this),e.jsxDEV(o,{mt:5,p:4,border:"2px dashed",borderColor:"gray.300",borderRadius:"md",onDrop:k,onDragOver:x,onClick:()=>{g.current&&g.current.click()},cursor:"pointer",children:N?e.jsxDEV(o,{position:"relative",children:[e.jsxDEV(L,{children:[a("files.form.selectedFile"),": ",N.name]},void 0,!0,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:150,columnNumber:19},this),e.jsxDEV(oe,{position:"absolute",right:-2,top:-2,size:"sm",onClick:()=>{u(null)}},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:152,columnNumber:19},this)]},void 0,!0,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:148,columnNumber:17},this):e.jsxDEV(o,{children:[e.jsxDEV(pe,{children:[" ",e.jsxDEV(I,{ref:g,type:"file",onChange:y,accept:"*",mb:4},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:166,columnNumber:21},this)]},void 0,!0,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:164,columnNumber:19},this),e.jsxDEV(ue,{children:[" ",e.jsxDEV(ye,{fontSize:32},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:178,columnNumber:21},this)]},void 0,!0,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:176,columnNumber:19},this),e.jsxDEV(L,{textAlign:"center",mt:3,children:[e.jsxDEV("b",{children:a("files.form.choose")},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:183,columnNumber:21},this)," ",a("files.form.dragHere"),".",e.jsxDEV("br",{},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:184,columnNumber:21},this),a("files.form.maxSize")]},void 0,!0,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:180,columnNumber:19},this)]},void 0,!0,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:163,columnNumber:17},this)},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:132,columnNumber:13},this)]},void 0,!0,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:111,columnNumber:11},this)},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:110,columnNumber:9},this),e.jsxDEV($,{},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:192,columnNumber:9},this),e.jsxDEV(Le,{py:3,children:[e.jsxDEV(z,{colorScheme:"gray",mr:3,onClick:s,size:"sm",children:a("files.buttons.close")},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:194,columnNumber:11},this),e.jsxDEV(z,{variant:"solid",size:"sm",colorScheme:"blue",type:"submit",isLoading:c,children:a("files.buttons.add")},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:201,columnNumber:11},this)]},void 0,!0,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:193,columnNumber:9},this)]},void 0,!0,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:100,columnNumber:7},this)]},void 0,!0,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/AddFile.jsx",lineNumber:94,columnNumber:5},this)}const Ue=(n,s)=>{const a=(n-1)*s;let c=a+s-1;return{startIndex:a,endIndex:c}},Qe=v().subtract(Pe,"days").format("YYYY-MM-DD"),qe=v().format("YYYY-MM-DD");function oa(){const{t:n}=Q(),[s,a]=l.useState(),{isOpen:c,onOpen:d,onClose:N}=S(),{hasPermission:u}=H(),{isOpen:g,onOpen:P,onClose:w}=S(),{isOpen:D,onOpen:E,onClose:t}=S(),[h,V]=l.useState(1),[F,A]=l.useState(""),k=je(F,1e3),[x,y]=l.useState({startDate:Qe,endDate:qe}),{startIndex:_,endIndex:r}=Ue(h,50),i=l.useRef(null),b=v(x.startDate).format("YYYY-MM-DD"),M=v(x.endDate).format("YYYY-MM-DD"),W=m=>{a(m)},J=async()=>{const m=await fe(q.token,`get_patient_file_page?start=${_}&end=${r}&search=${k}&start_date=${b}&end_date=${M}`);return{data:m==null?void 0:m.data.map(Z=>{const{id:ee,patient_id:ae,file_name:ie,file:se,f_name:me,l_name:re,phone:le,isd_code:te,updated_at:ne,created_at:ce}=Z;return{id:ee,patient_id:ae,"file name":e.jsxDEV(Re,{isExternal:!0,href:`${Ae}/${se}`,display:"flex",alignItems:"center",gap:3,children:[ie," ",e.jsxDEV(ge,{},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:102,columnNumber:25},this)]},void 0,!0,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:96,columnNumber:11},this),patient_Name:`${me} ${re}`,phone:`${te}${le}`,created_at:ce,updated_at:ne}}),total_record:m.total_record}},{data:p,isLoading:G,error:O}=Fe({queryKey:["all-files",k,h,b,M],queryFn:J}),K=m=>{V(m)},X=Math.ceil((p==null?void 0:p.total_record)/50);return l.useEffect(()=>{i.current&&i.current.scrollIntoView({behavior:"smooth",block:"start"})},[h]),O?e.jsxDEV(be,{errorCode:O.name},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:144,columnNumber:21},this):u("FILE_VIEW")?e.jsxDEV(o,{ref:i,children:[G||!p?e.jsxDEV(o,{children:[e.jsxDEV(j,{mb:5,justify:"space-between",children:[e.jsxDEV(C,{w:400,h:8},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:154,columnNumber:13},this),e.jsxDEV(C,{w:200,h:8},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:158,columnNumber:13},this)]},void 0,!0,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:151,columnNumber:11},this),[...Array(10)].map((m,Y)=>e.jsxDEV(C,{h:10,w:"100%",mt:2},Y,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:164,columnNumber:13},this))]},void 0,!0,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:150,columnNumber:9},this):e.jsxDEV(o,{children:[e.jsxDEV(j,{mb:5,justify:"space-between",align:"center",children:[e.jsxDEV(j,{align:"center",gap:4,children:[e.jsxDEV(I,{size:"md",placeholder:"Search",w:400,maxW:"50vw",onChange:m=>A(m.target.value),value:F},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:181,columnNumber:15},this),e.jsxDEV(Ee,{dateRange:x,setDateRange:y,size:"md"},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:190,columnNumber:15},this)]},void 0,!0,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:178,columnNumber:13},this),e.jsxDEV(o,{children:e.jsxDEV(z,{isDisabled:!u("FILE_ADD"),size:"sm",colorScheme:"blue",onClick:d,children:n("files.buttons.add")},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:197,columnNumber:15},this)},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:196,columnNumber:13},this)]},void 0,!0,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:174,columnNumber:11},this),e.jsxDEV(ke,{minPad:"8px 8px",data:p.data,onActionClick:e.jsxDEV(He,{onClick:W,DeleteonOpen:E,EditonOpen:P},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:212,columnNumber:15},this)},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:207,columnNumber:11},this),e.jsxDEV(j,{justify:"center",mt:4,children:e.jsxDEV(ve,{currentPage:h,onPageChange:K,totalPages:X},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:222,columnNumber:13},this)},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:219,columnNumber:11},this)]},void 0,!0,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:173,columnNumber:9},this),c&&e.jsxDEV($e,{isOpen:c,onClose:N},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:231,columnNumber:9},this),g&&e.jsxDEV(we,{isOpen:g,onClose:w,data:s},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:237,columnNumber:9},this),D&&e.jsxDEV(Ve,{isOpen:D,onClose:t,data:s},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:244,columnNumber:9},this)]},void 0,!0,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:148,columnNumber:5},this):e.jsxDEV(De,{},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:145,columnNumber:43},this)}const He=({onClick:n,rowData:s,DeleteonOpen:a,EditonOpen:c})=>{const{hasPermission:d}=H();return e.jsxDEV(j,{justify:"center",children:[d("FILE_UPDATE")&&e.jsxDEV(B,{"aria-label":"Edit file",size:"sm",variant:"ghost",_hover:{background:"none"},onClick:()=>{n(s),c()},icon:e.jsxDEV(Ne,{fontSize:18,color:R.colors.blue[500]},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:272,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:260,columnNumber:9},void 0),d("FILE_DELETE")&&e.jsxDEV(B,{"aria-label":"Delete file",size:"sm",variant:"ghost",_hover:{background:"none"},onClick:()=>{n(s),a()},icon:e.jsxDEV(xe,{fontSize:18,color:R.colors.red[500]},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:292,columnNumber:13},void 0)},void 0,!1,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:280,columnNumber:9},void 0)]},void 0,!0,{fileName:"/home/chan/medicare-samite/medicare-samite/packages/web-admin/src/Pages/Files/Files.jsx",lineNumber:258,columnNumber:5},void 0)};export{oa as default};
